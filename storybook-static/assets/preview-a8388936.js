import{R as h,r as l}from"./index-8db94870.js";import{u as k}from"./index-2d8213aa.js";import{R as N,e as y,b as P,g as K,f as M,h as j,i as H,j as U,k as Y}from"./index-4240c1c0.js";import"./_commonjsHelpers-042e6b4d.js";const{makeDecorator:G,addons:S}=__STORYBOOK_MODULE_PREVIEW_API__,{STORY_ARGS_UPDATED:q}=__STORYBOOK_MODULE_CORE_EVENTS__;var f="storybook/react-router-v6",W="reactRouter",r={CLEAR:`${f}/clear`,NAVIGATION:`${f}/navigation`,STORY_LOADED:`${f}/story-loaded`,ROUTE_MATCHES:`${f}/route-matches`,ACTION_INVOKED:`${f}/action_invoked`,ACTION_SETTLED:`${f}/action_settled`,LOADER_INVOKED:`${f}/loader_invoked`,LOADER_SETTLED:`${f}/loader_settled`},F=()=>{let a=P();return`${a.pathname}${a.search}${a.hash}`},C=h.createContext([]),$=()=>h.useContext(C),B=()=>{let a=l.useRef(0),t=P(),e=U(),[o]=k(),n=Y(),s=$(),d={};o.forEach((i,u)=>{d[u]=i});let c=F(),E=s.map(i=>[i.route.path,i.params]);return i=>{switch(i){case r.STORY_LOADED:{let u={url:c,path:t.pathname,routeParams:e,searchParams:d,routeMatches:E,hash:t.hash,routeState:t.state};return{key:`${r.STORY_LOADED}_${a.current++}`,type:r.STORY_LOADED,data:u}}case r.NAVIGATION:{let u={url:c,path:t.pathname,routeParams:e,searchParams:d,hash:t.hash,routeState:t.state,routeMatches:E,navigationType:n};return{key:`${r.NAVIGATION}_${a.current++}`,type:r.NAVIGATION,data:u}}case r.ROUTE_MATCHES:return{key:`${r.ROUTE_MATCHES}_${a.current++}`,type:r.ROUTE_MATCHES,data:{matches:E}}}}};function z(){let a={};return a.promise=new Promise((t,e)=>{a.resolve=t,a.reject=e}),a}function Z(a){let t={};return a.forEach((e,o)=>{if(e instanceof File){t[o]={filename:e.name,filesize:e.size,filetype:e.type};return}t[o]=e}),t}async function L(a){let t=a.clone(),e=t.headers.get("content-type")||"",o;switch(!0){case e.startsWith("text"):o=await t.text();break;case e.startsWith("application/json"):o=await t.json();break;case e.startsWith("multipart/form-data"):case e.startsWith("application/x-www-form-urlencoded"):{o=Z(await t.formData());break}default:await t.arrayBuffer().then(n=>n.byteLength)}return o}var J=({children:a})=>{let t=S.getChannel(),e=P(),[o,n]=l.useState(),[s,d]=l.useState(!1),[c,E]=l.useState([]),i=B(),u=$(),p=l.useRef(z());return l.useLayoutEffect(()=>{n(e)}),l.useEffect(()=>{s&&p.current.resolve()},[s]),l.useEffect(()=>{E(u);let O=setTimeout(()=>{s||(d(!0),t.emit(r.STORY_LOADED,i(r.STORY_LOADED)))},0);return()=>clearTimeout(O)},[s,u]),l.useEffect(()=>{o!==void 0&&o.key!==e.key&&p.current.promise.then(()=>{t.emit(r.NAVIGATION,i(r.NAVIGATION))})},[e]),l.useEffect(()=>{s&&u.length>c.length&&(E(u),t.emit(r.ROUTE_MATCHES,i(r.ROUTE_MATCHES)))},[u]),h.createElement(h.Fragment,null,a)},Q=({children:a,routePath:t,routeParams:e,searchParams:o,routeState:n,browserPath:s,hydrationData:d})=>{let c=S.getChannel(),[E,i]=l.useState(),[u,p]=l.useState(0),O=l.useRef();return c.on(q,()=>{p(_=>_+1)}),l.useLayoutEffect(()=>{let _=K(t||"",e),T=new URLSearchParams(o).toString(),R={search:T.length>0?`?${T}`:"",state:n};s!==void 0&&(R.pathname=s),s===void 0&&_!==""&&(R.pathname=_),O.current!==void 0&&Object.assign(R,O.current);let A=M(a),m=j(A,{initialEntries:[R],hydrationData:d});m.subscribe(D=>{O.current=D.location}),i(m)},[u]),E===void 0?null:h.createElement(H,{router:E,fallbackElement:h.createElement(X,null)})};function X(){return h.createElement("p",null,"Performing initial data load")}var V=()=>async(a,t)=>{switch(a){case r.ACTION_INVOKED:{let{request:e,params:o,context:n}=t,s={url:e.url,method:e.method,body:await L(e)};return{type:r.ACTION_INVOKED,data:{params:o,request:s,context:n}}}case r.ACTION_SETTLED:return{type:r.ACTION_SETTLED,data:t};case r.LOADER_INVOKED:{let{request:e,params:o,context:n}=t,s={url:e.url,method:e.method,body:L(e)};return{type:r.LOADER_INVOKED,data:{params:o,request:s,context:n}}}case r.LOADER_SETTLED:return{type:r.LOADER_SETTLED,data:t}}},ee=({children:a,browserPath:t,routePath:e="*",routeParams:o,routeHandle:n,searchParams:s,routeState:d,outlet:c,hydrationData:E,action:i,loader:u,errorElement:p,shouldRevalidate:O,routeId:_})=>{let T=S.getChannel(),[R,A]=l.useState([]);N.Provider._context=new Proxy(N.Provider._context??{},{set(x,w,v){return w==="_currentValue"&&A(I=>v!==void 0&&v.matches.length>I.length?v.matches:I),Reflect.set(x,w,v)}});let m=te(c)?c:{element:c},D={element:m.element,handle:m.handle,errorElement:m.errorElement,action:m.action!==void 0?b(T,m.action):void 0,loader:m.loader!==void 0?g(T,m.loader):void 0};return h.createElement(C.Provider,{value:R},h.createElement(Q,{routePath:e,routeParams:o,routeState:d,searchParams:s,browserPath:t,hydrationData:E},h.createElement(y,{id:_,path:e,handle:n,action:i!==void 0?b(T,i):void 0,loader:u!==void 0?g(T,u):void 0,shouldRevalidate:O,errorElement:p,element:h.createElement(J,null,a)},m.element!==void 0&&m.path===void 0&&h.createElement(y,{index:!0,...D}),m.element!==void 0&&h.createElement(y,{path:m.path,...D}))))};function te(a){return a!==null&&typeof a=="object"&&Object.prototype.hasOwnProperty.call(a,"element")}function b(a,t){let e=V();return async function(o){if(t===void 0)return;a.emit(r.ACTION_INVOKED,await e(r.ACTION_INVOKED,o));let n=await t(o);return a.emit(r.ACTION_SETTLED,await e(r.ACTION_SETTLED,n)),n}}function g(a,t){let e=V();return async function(o){if(t===void 0)return;a.emit(r.LOADER_INVOKED,await e(r.LOADER_INVOKED,o));let n=await t(o);return a.emit(r.LOADER_SETTLED,await e(r.LOADER_SETTLED,n)),n}}var ae=G({name:"withRouter",parameterName:W,wrapper:(a,t,{parameters:e={}})=>{let{routePath:o="*",routeParams:n,routeState:s,routeHandle:d,searchParams:c,outlet:E,browserPath:i,loader:u,action:p,errorElement:O,hydrationData:_,shouldRevalidate:T,routeId:R}=e;if(typeof o!="string")throw new Error("React Router decorator : `path` must be a string");if(n!==void 0&&typeof n!="object")throw new Error("React Router decorator : `params` must be an object with strings as values");if(c!==void 0&&typeof c!="object")throw new Error("React Router decorator : `search` must be an object with strings as values");return h.createElement(ee,{browserPath:i,routePath:o,routeParams:n,searchParams:c,routeState:s,routeHandle:d,outlet:E,loader:u,action:p,errorElement:O,hydrationData:_,shouldRevalidate:T,routeId:R},a(t))}});const ue={decorators:[ae],parameters:{actions:{argTypesRegex:"^on[A-Z].*"},controls:{matchers:{color:/(background|color)$/i,date:/Date$/}},reactRouter:{}}};export{ue as default};
//# sourceMappingURL=preview-a8388936.js.map
