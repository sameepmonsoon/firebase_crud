import{j as s}from"./jsx-runtime-94f6e698.js";import{u as q,A as z,H as O,a as T,b as _,l as I,c as H,P as $,U as M,d as B,e as W}from"./user-7199dc7e.js";import{r as a}from"./index-8db94870.js";import{L as G}from"./index-2d8213aa.js";import{v as h}from"./HandleFormValidation-b24a1880.js";import{P as J,R as K,b as Q,_ as N,d as X,a as u,p as Y,t as Z,u as V,f as ee,c as S}from"./ToastMessage-8e315cf6.js";import{a as se}from"./index-4240c1c0.js";import"./iconBase-3663c682.js";import"./index-8ce4a492.js";import"./_commonjsHelpers-042e6b4d.js";const te=()=>{const d=q(),{signUp:C}=a.useContext(z),[e,E]=a.useState([]),[t,b]=a.useState({}),[o,g]=a.useState("password"),[m,p]=a.useState(!1),R=se(),D=()=>{o==="text"&&g("password"),o==="password"&&g("text")},l=x=>{const{value:n,name:i}=x.target;E({...e,[i]:n})},F=async x=>{var n,i,w,j;if(x.preventDefault(),p(!0),b(h(e)),((n=Object.keys(h(e)))==null?void 0:n.length)===0&&((i=e==null?void 0:e.username)==null?void 0:i.trim().length)>0&&((w=e==null?void 0:e.password)==null?void 0:w.trim().length)>0){const L=K(N(S,"users"),Q("username","==",e==null?void 0:e.username));(await X(L)).docs.length!=0?(u("Username already in use."),b({username:"Username already in use."})):await C(e.email,e.password).then(async r=>{var y,v;d(I({email:r.user.email,uid:r.user.uid,displayName:e.username})),(e.roles==="admin"||e.roles==="user")&&await Y(N(S,"users"),{uid:(y=r==null?void 0:r.user)==null?void 0:y.uid,username:e.username,email:e.email,password:e.password,roles:e.roles}).then(f=>console.log(f)).catch(f=>{console.log(f.code)}),Z(`Welcome! ${e==null?void 0:e.username}`),await V((v=ee)==null?void 0:v.currentUser,{displayName:e==null?void 0:e.username}).then(()=>{R("/")})}).catch(r=>{r.code==="auth/email-already-in-use"&&u("Email already in use."),r.code==="auth/too-many-requests"?u("Too many attempts. Please wait."):u("Error signing up.")}).finally(()=>p(!1))}((j=Object.keys(h(e)))==null?void 0:j.length)>=0&&p(!1)};return s.jsx(O,{children:s.jsxs("form",{action:"",onSubmit:F,className:"overflow-x-hidden border-black/10 overflow-y-auto w-[20rem] sm:w-[32rem] h-[30rem] sm:h-[37rem] flex flex-col justify-start items-center p-10 bg-white border-[1px] shadow-md text-black rounded-sm gap-9",children:[s.jsx("p",{className:"w-full flex justify-center items-center text-2xl capitalize text-blue-600 font-[600] border-b-[1px] border-black/40 py-2",children:"sign up"}),s.jsxs("label",{htmlFor:"username",className:"w-full flex justify-center items-center flex-col text-sm gap-1",children:[s.jsx("input",{type:"text",name:"username",id:"username",required:!0,onChange:l,className:"border-[1px] outline-0 p-1 px-3 h-[2.7rem] w-full sm:w-[25rem] border-black/40  rounded-sm focus:outline focus:outline-2 focus:outline-blue-300 focus:outline-offset-1 focus:border-blue-500",placeholder:"User Name"}),t.username&&s.jsx("span",{className:"w-[95%] px-[2px] h-[1.5rem]  text-rose-400",children:t.username})]}),s.jsxs("label",{htmlFor:"email",className:"w-full flex justify-center items-center flex-col text-sm gap-1",children:[s.jsx("input",{type:"email",name:"email",required:!0,id:"email",onChange:l,className:"relative border-[1px] outline-0 p-1 px-3 h-[2.7rem] w-full sm:w-[25rem] border-black/40  rounded-sm focus:outline focus:outline-2 focus:outline-blue-300 focus:outline-offset-1 focus:border-blue-500",placeholder:"Email"}),t.email&&s.jsx("span",{className:"w-[95%] px-[2px] h-auto text-rose-400",children:t.email})]}),s.jsxs("label",{htmlFor:"Password",className:"w-full relative flex justify-center items-center flex-col text-sm gap-1",children:[s.jsx("input",{type:o,name:"password",required:!0,id:"Password",maxLength:10,onChange:l,className:" border-[1px] outline-0 p-1 h-[2.7rem] px-3 pr-10 w-full sm:w-[25rem] border-black/40 rounded-sm focus:outline focus:outline-2 focus:outline-blue-300 focus:outline-offset-1 focus:border-blue-500",placeholder:"Password"}),s.jsx("span",{className:"absolute right-6 top-[0.67rem] cursor-pointer hover:bg-gray-300/80 text-black/80 flex justify-center items-center p-[2px] rounded-full",onClick:D,children:o==="text"?s.jsx(T,{size:20}):s.jsx(_,{size:20})}),(t==null?void 0:t.password)&&s.jsx("span",{className:"relative w-[95%] px-[2px] h-auto text-rose-400",children:t.password})]}),s.jsxs("label",{htmlFor:"Role",className:"w-full flex justify-center items-center flex-col text-sm gap-1",children:[s.jsxs("select",{type:"text",name:"roles",id:"roles",required:!0,defaultValue:"",onChange:l,className:"appearance-none border-[1px] outline-0 p-1 h-[2.7rem] px-3 w-full sm:w-[25rem] border-black/40 rounded-sm focus:outline focus:outline-2 focus:outline-blue-300 focus:outline-offset-1 focus:border-blue-500",placeholder:"Select Role",children:[s.jsx("option",{value:"",disabled:!0,hidden:!0,children:"Select Role"}),s.jsx("option",{value:"admin",children:"Admin"}),s.jsx("option",{value:"user",children:"User"})]}),t.roles&&s.jsx("span",{className:"w-[95%] px-[2px] h-auto text-rose-4000",children:t.roles})]}),s.jsx("button",{disabled:m,type:"submit",className:`w-full sm:w-[25rem] capitalize bg-blue-600 flex justify-center  items-center min-h-[2.7rem] p-0 rounded-[3px] text-sm font-[500] text-white border-[1px] border-blue-200 hover:bg-blue-500 hover:border-blue-300 ${m?"cursor-not-allowed":"cursor-pointer"} `,children:m?s.jsx(J,{size:30,className:"animate-spin "}):"Sign Up"}),s.jsxs("div",{className:"w-full flex justify-center items-center gap-1 text-gray-700 flex-wrap",children:["Already Have an account?"," ",s.jsx(G,{to:"/signin",className:"underline underline-offset-2 decoration-1 italic hover:no-underline text-blue-500",children:"Sign In"})]})]})})},A=te,he={title:"Pages/Authentication",component:A,argTypes:{editDocData:{control:"object"}}},re=H({reducer:{auth:B,user:W}}),ae=d=>s.jsxs($,{store:re,children:[s.jsx(M,{children:s.jsx(A,{...d})})," "]}),c=ae.bind({});var P,U,k;c.parameters={...c.parameters,docs:{...(P=c.parameters)==null?void 0:P.docs,source:{originalSource:`args => {
  return <Provider store={store}>\r
      <UserAuthContextProvider>\r
        <SignUp {...args} />\r
      </UserAuthContextProvider>{" "}\r
    </Provider>;
}`,...(k=(U=c.parameters)==null?void 0:U.docs)==null?void 0:k.source}}};const be=["SignUpPage"];export{c as SignUpPage,be as __namedExportsOrder,he as default};
//# sourceMappingURL=SignUp.stories-c6a1d04c.js.map
